spring.application.name=tome-content

# Database Configuration
spring.datasource.url=jdbc:postgresql://db:5432/tomedb
spring.datasource.username=myuser
spring.datasource.password=secret
spring.datasource.drive-class-name=org.postgresql.Driver

# JPA/Hibernate Configuration
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

# Caching Configuration (Caffeine)
spring.cache.type=caffeine
spring.cache.caffeine.spec=maximumSize=1000,expireAfterWrite=1h
spring.cache.cache-names=hardcoverBooks,hardcoverSearch

# =====================================================
# External API Configuration
# =====================================================

# Generic External API Properties (prefix: external-api.services)
# Each service has: base-url, api-key, enabled, timeout.connect, timeout.read

# Hardcover API Configuration
external-api.services.hardcover.base-url=https://hardcover.app
external-api.services.hardcover.api-key=${HARDCOVER_API_TOKEN}
external-api.services.hardcover.enabled=true
external-api.services.hardcover.timeout.connect=5000
external-api.services.hardcover.timeout.read=10000

# Google Books API Configuration (stub - to be implemented)
# external-api.services.google_books.base-url=https://www.googleapis.com/books/v1
# external-api.services.google_books.api-key=${GOOGLE_BOOKS_API_KEY}
# external-api.services.google_books.enabled=false
# external-api.services.google_books.timeout.connect=5000
# external-api.services.google_books.timeout.read=10000

# Open Library API Configuration (stub - to be implemented)
# external-api.services.open_library.base-url=https://openlibrary.org
# external-api.services.open_library.enabled=false
# external-api.services.open_library.timeout.connect=5000
# external-api.services.open_library.timeout.read=10000

# =====================================================
# Resilience4j Circuit Breaker Configuration
# =====================================================

resilience4j.circuitbreaker.instances.hardcover.failure-rate-threshold=50
resilience4j.circuitbreaker.instances.hardcover.wait-duration-in-open-state=30s
resilience4j.circuitbreaker.instances.hardcover.permitted-number-of-calls-in-half-open-state=5
resilience4j.circuitbreaker.instances.hardcover.sliding-window-size=10
resilience4j.circuitbreaker.instances.hardcover.sliding-window-type=COUNT_BASED

# =====================================================
# Resilience4j Retry Configuration
# =====================================================

resilience4j.retry.instances.hardcover.max-attempts=3
resilience4j.retry.instances.hardcover.wait-duration=500ms
resilience4j.retry.instances.hardcover.retry-exceptions=java.io.IOException,java.net.SocketTimeoutException

# =====================================================
# Resilience4j Rate Limiter Configuration
# =====================================================

resilience4j.ratelimiter.instances.hardcover.limit-for-period=10
resilience4j.ratelimiter.instances.hardcover.limit-refresh-period=1s
resilience4j.ratelimiter.instances.hardcover.timeout-duration=5s
